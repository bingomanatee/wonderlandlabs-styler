(function(o,i){typeof exports=="object"&&typeof module<"u"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(o=typeof globalThis<"u"?globalThis:o||self,i(o.Styler={}))})(this,function(o){"use strict";var lt=Object.defineProperty;var yt=(o,i,a)=>i in o?lt(o,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[i]=a;var b=(o,i,a)=>yt(o,typeof i!="symbol"?i+"":i,a);function i(e){return!!(e&&typeof e=="object")}function a(e){if(!i(e))return!1;const t=e;return!!("light"in t&&t.light||"dark"in t&&t.dark)}function $(e){if(!i(e))return!1;const t=e;return Array.from(Object.keys(t)).every(r=>typeof t[r]=="string"||typeof t[r]=="number"||a(t[r]))}const k=$;var A=typeof global=="object"&&global&&global.Object===Object&&global,M=typeof self=="object"&&self&&self.Object===Object&&self,d=A||M||Function("return this")(),l=d.Symbol,S=Object.prototype,_=S.hasOwnProperty,F=S.toString,u=l?l.toStringTag:void 0;function L(e){var t=_.call(e,u),r=e[u];try{e[u]=void 0;var n=!0}catch{}var s=F.call(e);return n&&(t?e[u]=r:delete e[u]),s}var I=Object.prototype,x=I.toString;function C(e){return x.call(e)}var E="[object Null]",V="[object Undefined]",O=l?l.toStringTag:void 0;function J(e){return e==null?e===void 0?V:E:O&&O in Object(e)?L(e):C(e)}function j(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var R="[object AsyncFunction]",G="[object Function]",K="[object GeneratorFunction]",q="[object Proxy]";function D(e){if(!j(e))return!1;var t=J(e);return t==G||t==K||t==R||t==q}var h=d["__core-js_shared__"],v=function(){var e=/[^.]+$/.exec(h&&h.keys&&h.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function z(e){return!!v&&v in e}var H=Function.prototype,N=H.toString;function U(e){if(e!=null){try{return N.call(e)}catch{}try{return e+""}catch{}}return""}var Z=/[\\^$.*+?()[\]{}|]/g,B=/^\[object .+?Constructor\]$/,Q=Function.prototype,W=Object.prototype,X=Q.toString,Y=W.hasOwnProperty,tt=RegExp("^"+X.call(Y).replace(Z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function et(e){if(!j(e)||z(e))return!1;var t=D(e)?tt:B;return t.test(U(e))}function rt(e,t){return e==null?void 0:e[t]}function nt(e,t){var r=rt(e,t);return et(r)?r:void 0}var T=function(){try{var e=nt(Object,"defineProperty");return e({},"",{}),e}catch{}}();function st(e,t,r){t=="__proto__"&&T?T(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function it(e,t){return e===t||e!==e&&t!==t}var ot=Object.prototype,ct=ot.hasOwnProperty;function at(e,t,r){var n=e[t];(!(ct.call(e,t)&&it(n,r))||r===void 0&&!(t in e))&&st(e,t,r)}function ft(e,t,r){for(var n=-1,s=e.length,c=t.length,f={};++n<s;){var p=n<c?t[n]:void 0;r(f,e[n],p)}return f}function ut(e,t){return ft(e||[],t||[],at)}const m=new Map([["appearance",8],["variant",4]]);function P(e){return Array.from(Object.keys(e)).length}class w{constructor(t,r){this.style=t,this.attrs=r}haveAllKeysOf(t){return Array.from(Object.keys(t)).every(r=>r in this.attrs)}get attrCount(){return P(this.attrs)}isLessSpecific(t){return this.keysPresentIn(t)&&this.attrCount<P(t)}isLessSpecificMatch(t){return this.isLessSpecific(t)&&Object.keys(this.attrs).every(r=>this.attrs[r]===t[r])}get specificity(){let t=0;for(const r of Object.keys(this.attrs))m.has(r)?t+=m.get(r):t+=1;return t}keysPresentIn(t){for(const r of Object.keys(this.attrs))if(!(r in t))return!1;return!0}matches(t){return this.haveAllKeysOf(t)&&this.keysPresentIn(t)&&Array.from(Object.keys(this.attrs)).every(r=>this.attrs[r]===t[r])}toJSON(){const t={style:{},attrs:{}};return Array.from(Object.keys(this.style)).sort().forEach(r=>{t.style[r]=this.style[r]}),Array.from(Object.keys(this.attrs)).sort().forEach(r=>{t.attrs[r]=this.attrs[r]}),t}toString(){return JSON.stringify(this.toJSON())}equals(t){return t.toString()===this.toString()}}const g=class g{constructor(){b(this,"targetStyles",new Map)}add(t,r,n){const s=new w(r,n);this.targetStyles.has(t)?(this.targetStyles.get(t).some(c=>c.matches(n))&&console.warn("added multiple definitions for target",t,"attrs",n),this.targetStyles.get(t).push(s)):this.targetStyles.set(t,[s])}perfectMatches(t,r){if(!this.targetStyles.has(t))return[];const n=[];for(const s of this.targetStyles.get(t))s.matches(r)&&n.push(s);return n}lessSpecificStyles(t,r){return this.targetStyles.has(t)?this.targetStyles.get(t).filter(n=>(console.log(r,"lses specific",n.toString(),n.isLessSpecificMatch(r)),n.isLessSpecificMatch(r))).sort((n,s)=>s.specificity-n.specificity):[]}for(t,r){if(!(t&&r))throw new Error("must have target and attrs");const[n]=this.perfectMatches(t,r);return[...this.lessSpecificStyles(t,r).map(c=>c.style),(n==null?void 0:n.style)||{}].reduce((c,f)=>({...c,...f}),{})}addMany(t,r,n=[]){if(r.includes("target")||(r=[...r,"target"]),k(t)){const s=Math.min(r.length,n.length),c=ut(r.slice(0,s),n.slice(0,s));if(!("target"in c))return;const{target:f,...p}=c;this.add(f,t,p)}else for(const s of Object.keys(t)){const c=t[s];i(c)&&n.length<r.length&&this.addMany(c,r,[...n,s])}}};b(g,"Singleton",new g);let y=g;o.Styler=y,o.StylerStyle=w,o.default=y,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
